package com.isra.security.dependency_analyzer.DTOs;

import com.isra.security.dependency_analyzer.Entities.Vulnerability;
import com.isra.security.dependency_analyzer.Utils.HelperUtils;

public class VulnerabilityResponse {
    private String cveID;
    private String severity;
    private  String description;
    private String remediation;

    public String getCveID() {
        return cveID;
    }

    public void setCveID(String cveID) {
        this.cveID = cveID;
    }

    public String getSeverity() {
        return severity;
    }

    public void setSeverity(String severity) {
        this.severity = severity;
    }

    public String getDescription() {
        return description;
    }

    public void setDescription(String description) {
        this.description = description;
    }

    public String getRemediation() {
        return remediation;
    }

    public void setRemediation(String remediation) {
        this.remediation = remediation;
    }

    public static VulnerabilityResponse convertToDTO(Vulnerability vulnerability){
        VulnerabilityResponse dto = new VulnerabilityResponse();
        if (HelperUtils.isNotNull(vulnerability)){
            dto.setCveID(vulnerability.getCveID());
            dto.setSeverity(vulnerability.getSeverity());
            dto.setDescription(vulnerability.getDescription());
            dto.setRemediation(vulnerability.getRemediation());
        }
        return dto;
    }

    public static Vulnerability convertToEntity(VulnerabilityResponse dto){
        Vulnerability entity = new Vulnerability();
        if(HelperUtils.isNotNull(dto)){
            entity.setCveID(dto.getCveID());
            entity.setSeverity(dto.getSeverity());
            entity.setDescription(dto.getDescription());
            entity.setRemediation(dto.getRemediation());
        }
        return entity;
    }
}
